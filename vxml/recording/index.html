<!doctype html>
<html lang="en">
<head>
    <!-- Meta Information -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>Nexmo Quickstarts - VoiceXML: Recording Audio </title>

    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="/Quickstarts/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="/Quickstarts/css/nexmo.css">
    <link rel="stylesheet" type="text/css" href="/Quickstarts/css/font-awesome.min.css">
</head><body>
<header>
    <div class="container-fluid header-meta">
        <h1 class="hide">Nexmo</h1>
        <a href="https://nexmo.com"><img src="/Quickstarts/img/nexmo-logo--white.svg" alt="Nexmo" class="page-logo"></a>
		<div class="navbar navbar-default">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button>
            </div>
            <nav id="navbar-collapse" class="pull-right collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li><a href="/Quickstarts/">Quickstarts</a></li>
                    <li><a href="https://nexmo.com">Nexmo.com</a></li>
                </ul>
            </nav>
        </div>
    </div>
    <div class="container-fluid">
        <div class="row text-center header-title">
            <div class="col-md-12">
                <h2 id='title'>  VoiceXML: Recording Audio </h2>
                <!-- <div class="lead">The purpose of VoiceXML is to present the caller - or user - with information, and prompt the user for a response. 
Sometimes this is [recognized speech or DTMF digits][input], but it could also be recorded audio. </div> -->
            </div>
        </div>
    </div>
</header><!-- ********************************* Container ******************************************* -->
<section class="body-container">
  <div class="container">
    <div class="col-md-3 aside">
        <aside>
            <div class="side-menu-container">
                    <div class="side-menu SMS">
                        <h4>SMS</h4>
                        <ul class="list-unstyled">
                                <li ><a href="/Quickstarts/./sms/send/">Sending Your First SMS</a> <span>»</span></li>
                                <li ><a href="/Quickstarts/./sms/receive/">Receiving Your First SMS</a> <span>»</span></li>
                                <li ><a href="/Quickstarts/./sms/reply/">Replying to SMS Messages</a> <span>»</span></li>
                        </ul>
                    </div>
                    <div class="side-menu Voice">
                        <h4>Voice</h4>
                        <ul class="list-unstyled">
                                <li ><a href="/Quickstarts/./tts/">Delivering Messages with Voice</a> <span>»</span></li>
                                <li ><a href="/Quickstarts/./voice/inbound/">Receiving Your First Call</a> <span>»</span></li>
                                <li ><a href="/Quickstarts/./voice/outbound/">Making An Outbound Call</a> <span>»</span></li>
                        </ul>
                    </div>
                    <div class="side-menu VoiceXML">
                        <h4>VoiceXML</h4>
                        <ul class="list-unstyled">
                                <li ><a href="/Quickstarts/./vxml/input/">Prompting for Input</a> <span>»</span></li>
                                <li class="current"><a href="/Quickstarts/./vxml/recording/">Recording Audio</a> <span>»</span></li>
                                <li ><a href="/Quickstarts/./vxml/transfer/">Transferring a Call</a> <span>»</span></li>
                                <li ><a href="/Quickstarts/./vxml/multi/">Multiple Items and Forms</a> <span>»</span></li>
                                <li ><a href="/Quickstarts/./vxml/errors/">Error Events</a> <span>»</span></li>
                        </ul>
                    </div>
                    <div class="side-menu Verify">
                        <h4>Verify</h4>
                        <ul class="list-unstyled">
                                <li ><a href="/Quickstarts/./verify/verify/">Verifying a Phone Number</a> <span>»</span></li>
                        </ul>
                    </div>
            </div>
        </aside>
    </div><!-- ********************************* Body ******************************************* -->
    <div class="col-md-9">
      <section class="body-content">
        <div class="row">
          <div class="col-md-12"><p>The purpose of VoiceXML is to present the caller - or user - with information, and prompt the user for a response.
Sometimes this is <a href="../input">recognized speech or DTMF digits</a>, but it could also be recorded audio.</p>
<p>Like most VoiceXML documents, it starts with a <code>&lt;form&gt;</code>. To keep things simple, we'll place a <code>&lt;submit&gt;</code> element
inside of a <code>&lt;block&gt;</code> at the end of the form so it is executed automatically, and the data sent to the <code>next</code> URL.</p>
<p>Since we'll be sending an audio file, we'll set the <code>enctype</code> to <code>multipart/form-data</code> so our server side code can
handle it just like a file upload from an HTML form.</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;vxml version = &quot;2.1&quot;&gt;
    &lt;form&gt;
        &lt;block&gt;
            &lt;submit next=&quot;../php/form.php&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;/&gt;
        &lt;/block&gt;
    &lt;/form&gt;
&lt;/vxml&gt;
</code></pre>
<pre><code>&lt;block&gt;
    &lt;submit next=&quot;./../form.php&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;/&gt;
&lt;/block&gt;
</code></pre>
<p>Instead of <code>&lt;field&gt;</code> we'll use <code>&lt;record&gt;</code> to capture a recording. Like <code>&lt;field&gt;</code> the <code>name</code> attribute defines how the
recording is referenced in the VoiceXML document, and what name is used when the data is submitted to a URL. Other
attributes like <code>beep</code> and <code>maxtime</code> allow you to control the recording process. For more information, talk a look at
the <a href="http://www.w3.org/TR/voicexml20/#dml2.3.6" class="external-link">W3C documentation on the <code>&lt;record&gt;</code> element</a>.</p>
<p>We can nest a <code>&lt;prompt&gt;</code> inside to tell the caller what we want them to record:</p>
<pre><code>&lt;record name=&quot;message&quot; beep=&quot;true&quot; maxtime=&quot;60s&quot;&gt;
    &lt;prompt&gt;Please leave your message after the beep, then press any key.&lt;/prompt&gt;
&lt;/record&gt;        
</code></pre>
<pre><code>&lt;record name=&quot;message&quot; beep=&quot;true&quot; maxtime=&quot;60s&quot;&gt;
    &lt;prompt&gt;Please leave your message after the beep, then press any key.&lt;/prompt&gt;
&lt;/record&gt;
</code></pre>
<p>At this point, the caller would be prompted to record some audio, and that recording would be submitted to the URL.
However, we can also use the recording in the VoiceXML document itself, so let's play it back to the caller using
another <code>&lt;prompt&gt;</code> along with the the <code>&lt;value&gt;</code> element. The expression for <code>&lt;value&gt;</code> will be the name of the recording.</p>
<pre><code>&lt;block&gt;
    &lt;prompt&gt;Here's what you recorded &lt;value expr=&quot;message&quot;/&gt;.&lt;/prompt&gt;
&lt;/block&gt;
</code></pre>
<pre><code>&lt;block&gt;
    &lt;prompt&gt;Here's what you recorded &lt;value expr=&quot;message&quot;/&gt;.&lt;/prompt&gt;
&lt;/block&gt;
</code></pre>
<p>Now our simple VoiceXML document prompts the caller to record a message, and plays it back to them.</p>
<div class="code-snippets">
    <ul class="nav nav-tabs">
                <li role="presentation" class="Full VXML54ef6acde0028 active"><a href="#Full VXML54ef6acde0028" aria-controls="Full VXML54ef6acde0028" role="tab" data-toggle="tab">Full VXML</a></li>
            </ul>
    <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="Full VXML54ef6acde0028">
            <pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;vxml version = &quot;2.1&quot;&gt;
    &lt;form&gt;
        &lt;record name=&quot;message&quot; beep=&quot;true&quot; maxtime=&quot;60s&quot;&gt;
            &lt;prompt&gt;Please leave your message after the beep, then press any key.&lt;/prompt&gt;
        &lt;/record&gt;
        &lt;block&gt;
            &lt;prompt&gt;Here's what you recorded &lt;value expr=&quot;message&quot;/&gt;.&lt;/prompt&gt;
        &lt;/block&gt;
        &lt;block&gt;
            &lt;submit next=&quot;./../form.php&quot; enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;/&gt;
        &lt;/block&gt;
    &lt;/form&gt;
&lt;/vxml&gt;</code></pre>
        </div>
            </div>
</div>
<p>Once the caller has provided a value for <code>&lt;record&gt;</code>, the <code>&lt;block&gt;</code> element at the enc of the form is  executed, and the
recording is sent to the defined URL. If VoiceXML is returned by that URL, the call continues. Here's a simple server
side script to save the recording.</p>
<div class="code-snippets">
    <ul class="nav nav-tabs">
                <li role="presentation" class="PHP54ef6acde040c active"><a href="#PHP54ef6acde040c" aria-controls="PHP54ef6acde040c" role="tab" data-toggle="tab">PHP</a></li>
            </ul>
    <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="PHP54ef6acde040c">
            <pre><code>&lt;?php
if(!isset($_FILES['message'])){
    return; //not a post from our script
}

switch($_FILES['message']['error']){
    case UPLOAD_ERR_OK:
        move_uploaded_file($_FILES['message']['tmp_name'], './recordings/' . $_FILES['message']['name']);
        $prompt = 'Thanks, your message has been saved.';
        break;
    default:
        $prompt = 'Sorry, we could not save your message.';
}
echo '&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;';
?&gt;
&lt;vxml version=&quot;2.1&quot;&gt;
    &lt;form&gt;
        &lt;block&gt;
            &lt;prompt&gt;&lt;?php echo $prompt ?&gt;&lt;/prompt&gt;
        &lt;/block&gt;
    &lt;/form&gt;
&lt;/vxml&gt;</code></pre>
        </div>
            </div>
</div>
<p>Want to dig a little deeper into VoiceXML? Check out the W3C's documentation of <a href="http://www.w3.org/TR/voicexml20/#dml2.1" class="external-link"><code>&lt;form&gt;</code></a>, <a href="http://www.w3.org/TR/voicexml20/#dml2.3.6" class="external-link"><code>&lt;record&gt;</code></a>,
and <a href="http://www.w3.org/TR/voicexml20/#dml4.1.4" class="external-link"><code>&lt;value&gt;</code></a>.</p>
</div>
        </div>
        <div class="row next">
          <div class="col-md-12">
            <a href="/Quickstarts/./vxml/transfer/" class="btn"><span>Next</span>: Transferring a Call <span class="glyphicon glyphicon-play"></span></a>
          </div>
        </div>
      </section>
    </div>
<!-- ********************************* End Body ******************************************* -->
  </div>
</section>
<!-- ********************************* End Container ******************************************* -->

<footer>
  <div class="container-fluid pre-footer">
    <div class="row">
      <div class="col-md-12">
<div class="cta cta--flex-center">
			<div class="cta__eq cta__primary">
				<span class="block">Start using Nexmo today</span>
			</div>
			<div class="cta__eq cta__secondary">
			<a href="https://dashboard.nexmo.com/register" class="btn">Try it for free</a>
			</div>
		</div>
</div>
    </div>
  </div>
  <div class="container">
    <div class="col-md-4">
      <ul  class="nav copyright">
        <li><img src="/Quickstarts/img/footer-logo.svg" alt="nexmo" class="footer-logo"></li>
        <li>© 2015 Nexmo Inc.</li>
        <li>
          <ul class="footer-social">
            <li> <a href="https://twitter.com/nexmo" class="social-icon--twitter" target="_blank"> <span class="hide">Twitter</span> </a> </li>
            <li> <a href="https://www.facebook.com/Nexmo" class="social-icon--facebook" target="_blank"> <span class="hide">Facebook</span> </a> </li>
            <li> <a href="https://www.linkedin.com/company/nexmo" class="social-icon--linkedin" target="_blank"> <span class="hide">Linkedin</span> </a> </li>
          </ul>
        </li>
      </ul>
    </div>
    <div class="col-md-2">
      <ul class="nav">
        <li> Resources </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/blog">Blog</a> </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/webinars">Webinars</a> </li>
        <li> <a hreflang="en" href="https://labs.nexmo.com/">Labs</a> </li>
      </ul>
    </div>
    <div class="col-md-2">
      <ul class="nav">
        <li> Customers </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/customers/#case-studies">Case Studies</a> </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/customers/#trust-nexmo">Trust Nexmo</a> </li>
      </ul>
    </div>
    <div class="col-md-2">
      <ul class="nav">
        <li> Company </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/company/us/">About</a> </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/company/leadership/">Leadership</a> </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/company/press">Press</a> </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/company/events">Events</a> </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/company/careers">Careers</a> </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/contact-us">Contact us</a> </li>
      </ul>
    </div>
    <div class="col-md-2">
      <ul class="nav">
        <li> &nbsp; </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/terms-use">Terms of use</a> </li>
        <li> <a hreflang="en" href="https://www.nexmo.com/privacy-policy">Privacy policy</a> </li>
      </ul>
    </div>
  </div>
  </div>
</footer><!-- JS -->
<script src="/Quickstarts/js/jquery-1.11.2.min.js"></script>
<script src="/Quickstarts/js/bootstrap.min.js"></script>
<script src="/Quickstarts/js/nexmo.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script src="//f.vimeocdn.com/js/froogaloop2.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script>
    var environment = 'production';
    var track = (environment == 'production');

    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-20475086-4', 'auto');
    if(track){
        ga('send', 'pageview');
    } else {
        console.log('skipped sending pageview');
    }

    var trackOutboundLink = function(url) {
        if(track){
            ga('send', 'event', 'outbound', 'click', url, {'hitCallback':
                    function () {
                        document.location = url;
                    }
            });
        } else {
            console.log('skipped sending outbound link: ' + url);
            document.location = url;
        }
    }

    var getVimeoCallback = function(event){
        var sent = false;
        return function(id){
            if(!sent){
                var player = $f(id);
                sent = true;
                player.api('getVideoUrl', function(url){
                    if(track){
                        ga('send', 'event', 'video', event, url);
                    } else {
                        console.log('skipped sending video event: ' + event + ' ' + url);
                    }
                });
            }
        }
    };

    $(function(){
        $('a.external-link').click(function(){
            trackOutboundLink($(this).attr('href'));
            return false;
        });

        var frame = $("#screencast")[0];
        if(frame){
            $f(frame).addEvent('ready', function(id){
                var player = $f(id);
                player.addEvent('play', getVimeoCallback('play'));
                player.addEvent('finish', getVimeoCallback('finish'));
            });
        }
    });

</script>
<!--[if lt IE 9]>
  <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
</body>
</html>
